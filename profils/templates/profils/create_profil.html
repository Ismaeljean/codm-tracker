{% extends 'base.html' %}
{% load static %}

{% block title %}Créer mon Profil - CODM Tracker{% endblock %}

{% block content %}
<div class="auth-container">
    <div class="auth-card" style="max-width: 700px;">
        <div class="auth-header">
            <div class="auth-logo">
                <div class="logo-icon">CT</div>
                <div class="logo-text">CODM<span>Tracker</span></div>
            </div>
            <h1 class="auth-title">Créer votre Profil Joueur</h1>
            <p class="auth-subtitle">Complétez votre profil pour commencer à suivre vos statistiques</p>
        </div>
        
        <form method="POST" action="{% url 'profils:create_profil' %}" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="form-group">
                <label class="form-label" for="uid_codm">UID CODM (optionnel)</label>
                <input type="text" id="uid_codm" name="uid_codm" class="form-input" placeholder="Votre UID Call of Duty Mobile">
                <small style="color: var(--text-grey); font-size: 0.85rem; display: block; margin-top: 5px;">Vous pouvez le trouver dans les paramètres du jeu</small>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="avatar">Image de Profil (optionnel)</label>
                <div id="avatar-preview-container" style="margin-bottom: 15px;">
                    <img id="avatar-preview" src="" alt="Aperçu" style="max-width: 150px; max-height: 150px; width: 150px; height: 150px; border-radius: 50%; border: 2px solid var(--primary-red); object-fit: cover; display: none;">
                </div>
                <input type="file" id="avatar" name="avatar" class="form-input" accept="image/*">
                <small style="color: var(--text-grey); font-size: 0.85rem; display: block; margin-top: 5px;">Formats acceptés: JPG, PNG, GIF. Taille max: 5MB</small>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="niveau">Niveau</label>
                <input type="number" id="niveau" name="niveau" class="form-input" placeholder="1" min="1" max="400" value="1" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="rang_mj">Rang Multijoueur</label>
                <select id="rang_mj" name="rang_mj" class="form-input" required>
                    <option value="">Sélectionnez votre rang</option>
                    <option value="Recrue">Recrue</option>
                    <option value="Vétéran">Vétéran</option>
                    <option value="Élite">Élite</option>
                    <option value="Pro">Pro</option>
                    <option value="Maître">Maître</option>
                    <option value="Grand Maître">Grand Maître</option>
                    <option value="Légendaire">Légendaire</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="rang_br">Rang Battle Royale</label>
                <select id="rang_br" name="rang_br" class="form-input" required>
                    <option value="">Sélectionnez votre rang</option>
                    <option value="Bronze">Bronze</option>
                    <option value="Argent">Argent</option>
                    <option value="Or">Or</option>
                    <option value="Platine">Platine</option>
                    <option value="Diamant">Diamant</option>
                    <option value="Maître">Maître</option>
                    <option value="Grand Maître">Grand Maître</option>
                    <option value="Légendaire">Légendaire</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="bio">Bio (optionnel)</label>
                <textarea id="bio" name="bio" class="form-input" rows="4" placeholder="Parlez-nous de vous..."></textarea>
            </div>
            
            <button type="submit" class="btn btn-primary" style="width: 100%;">
                <i class="fas fa-check"></i>
                Créer mon Profil
            </button>
        </form>
        
        <div class="auth-footer">
            <p><a href="/" style="color: var(--primary-red);">Passer cette étape pour l'instant</a></p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const avatarInput = document.getElementById('avatar');
    const avatarPreview = document.getElementById('avatar-preview');
    
    if (avatarInput && avatarPreview) {
        avatarInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                // Vérifier la taille du fichier (5MB max)
                if (file.size > 5 * 1024 * 1024) {
                    alert('Le fichier est trop volumineux. Taille maximum: 5MB');
                    this.value = '';
                    avatarPreview.style.display = 'none';
                    return;
                }
                
                // Vérifier le type de fichier
                if (!file.type.match('image.*')) {
                    alert('Veuillez sélectionner une image valide (JPG, PNG, GIF)');
                    this.value = '';
                    avatarPreview.style.display = 'none';
                    return;
                }
                
                // Créer un FileReader pour prévisualiser
                const reader = new FileReader();
                reader.onload = function(e) {
                    avatarPreview.src = e.target.result;
                    avatarPreview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                avatarPreview.style.display = 'none';
            }
        });
    }
});
</script>
{% endblock %}
